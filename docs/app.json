[{"name":"app.R","content":"# Creating an interactive plot for presentation purposes\r\n# JA 30/10/2024\r\n\r\nlibrary(tidyverse)\r\nlibrary(cowplot)\r\nlibrary(shiny)\r\nlibrary(bslib)\r\n\r\n# Create a function to simulate coin tosses\r\nflipr <- function(n = 1, size = 10, prob = 0.5) {\r\n  rbinom(n = n,\r\n         size = size,\r\n         prob = prob)\r\n}\r\n\r\n# Define UI for app that draws a histogram ----\r\nui <- fluidPage(\r\n  # App title ----\r\n  titlePanel(\"Simulate a coin toss experiment with a biased coin\"),\r\n  \r\n  # Sidebar layout with input and output definitions ----\r\n  sidebarLayout(\r\n    # Sidebar panel for inputs ----\r\n    sidebarPanel(\r\n      # Input 1: n ----\r\n      sliderInput(\r\n        inputId = \"n\",\r\n        label = \"n (number of experiments):\",\r\n        min = 0,\r\n        max = 100,\r\n        value = 10,\r\n        step = 1 # Step size for finer control\r\n      ),\r\n      \r\n      # Input 2: size ----\r\n      sliderInput(\r\n        inputId = \"size\",\r\n        label = \"size (number of coin tosses in each experiment):\",\r\n        min = 1,\r\n        max = 20,\r\n        value = 5,\r\n        step = 1 # Step size for finer control\r\n      ),\r\n      \r\n      # Input 3: theta ----\r\n      sliderInput(\r\n        inputId = \"theta\",\r\n        label = \"theta ('bias' - the (true) probability of heads):\",\r\n        min = 0,\r\n        max = 1,\r\n        value = 0.5,\r\n        step = 0.1 # Step size for finer control\r\n      ),\r\n      \r\n      hr(), # Add a horizontal rule\r\n      \r\n      # Input 4: fit_model ----\r\n      checkboxInput(inputId = \"fit_model\",\r\n                    label = \"Fit model to data\",\r\n                    value = TRUE)\r\n      \r\n    ),\r\n    \r\n    # Main panel for displaying outputs ----\r\n    mainPanel(\r\n      # Output: Histogram of data w/ or w/o density ----\r\n      plotOutput(outputId = \"plot\")\r\n    )\r\n  )\r\n)\r\n\r\n# Define server logic to plot example rat data ----\r\nserver <- function(input, output) {\r\n  \r\n  # Plot example data (histogram)\r\n  output$plot <- renderPlot({\r\n    \r\n    \r\n    flips <- data.frame(\r\n      expt = 1:input$n,\r\n      result = flipr(n = input$n,\r\n                     size = input$size,\r\n                     prob = input$theta\r\n      )\r\n    )\r\n    \r\n    plot_histogram <-\r\n      ggplot(data = flips,\r\n             aes(x = result)) +\r\n      geom_histogram() +\r\n      geom_vline(aes(xintercept = mean(result)),\r\n                 linetype = 'dashed',\r\n                 colour = 'blue') +\r\n      theme_bw()\r\n    \r\n    # We already have a result (number of heads) -\r\n    # what is the LIKELIHOOD of each theta?\r\n    likelihood_density <- \r\n      data.frame(theta = seq(0, 1, by = 0.01),\r\n                 likelihood = dbinom(x = sum(flips$result),\r\n                                     size = input$n * input$size,\r\n                                     prob = seq(from = 0, \r\n                                                to = 1,\r\n                                                by = 0.01)\r\n                 )\r\n      )\r\n    \r\n    # Let's graph that with ggplot\r\n    plot_density <-\r\n      ggplot(data = data.frame(likelihood_density),\r\n             aes(x = theta,\r\n                 y = likelihood)\r\n      ) +\r\n      geom_line() +\r\n      theme_bw() +\r\n      xlab('LIKELIHOOD of the parameter theta (\"prob\") given (all) the data in flip')\r\n    \r\n    if (input$fit_model == TRUE) {\r\n      to_plot <- cowplot::plot_grid(plotlist = list(plot_histogram,\r\n                                                    plot_density),\r\n                                    ncol = 1)\r\n    } else if (input$fit_model == FALSE) {\r\n      to_plot <- plot_histogram\r\n    }\r\n    \r\n    to_plot\r\n    \r\n  })\r\n  \r\n}\r\n\r\n# Launch the shiny app\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"shiny_coins.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"}]
